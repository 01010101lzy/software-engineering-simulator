---
title: 需求规格说明书

toc: true
toc-title: 目录
toc-depth: 2
numbersections: true

lang: zh-CN

fontsize: 11pt
linestretch: 1.05

documentclass: scrartcl 

linkcolor: blue

mainfont: Tinos
mainfontoptions:
  - BoldFont=Tinos Bold
  - ItalicFont=Tinos Italic
  - BoldItalicFont=Tinos Bold Italic
CJKmainfont: Source Han Serif CN
CJKmainfontoptions:
  - BoldFont=Source Han Serif CN Bold
  - ItalicFont=Source Han Serif CN Italic
  - BoldItalicFont=Source Han Serif CN Bold Italic
monofont: Iosevka
monofontoptions:
  - BoldFont=Iosevka Bold
  - ItalicFont=Iosevka Italic
  - BoldItalicFont=Iosevka Bold Italic
CJKmonofont: Source Han Sans SC
CJKmonofontoptions:
  - BoldFont=Source Han Sans SC Bold
  - ItalicFont=Source Han Sans SC Italic
  - BoldItalicFont=Source Han Sans SC Bold Italic

header-includes:
  - \usepackage{xeCJK}
  - \XeTeXlinebreaklocale "zh"
  - \XeTeXlinebreakskip = 0pt plus 1pt minus 0.1pt
---

# 概述

软件工程模拟器（Software Engineering Simulator, 缩写为 SESim）是一款模拟软件开发过程的游戏。

## 目标用户简介

本游戏的目标用户是普通及偏硬核的电脑游戏玩家。

## 项目的目的与目标

### 目的

N/A（我们想做游戏）

<!-- 做游戏需要目的吗？ -->

### 目标

- 游戏可以正常运行
- 难度适中（或偏高），游戏性强

## 定义

- N/A: Not Applicable，无、不适用
- 玩家: 指游玩此游戏的人
- 系统/程序: 指游戏本身

## 参考资料

1. Unity Scripting Reference (<https://docs.unity3d.com/ScriptReference>)
2. Unity Manual (<https://docs.unity3d.com/Manual>)
3. Microsoft Docs (<https://docs.microsoft.com/zh-cn/>)

## 相关文档

1. 软件开发计划书 (<https://github.com/01010101lzy/software-engineering-simulator/blob/master/docs/homework/dev_plan.md>)

## 版本历史

见本文件的 [版本历史][git_history]。

[git_history]: https://github.com/01010101lzy/software-engineering-simulator/commits/master/docs/homework/spec.md

# 系统环境

《软件工程模拟器》的目标系统需求如下：

|   配置 | 需求                                                            |
| -----: | --------------------------------------------------------------- |
|    CPU | x86_64 架构，2.40GHz 以上                                       |
|   内存 | 2GiB 及以上                                                     |
|   显卡 | Intel HD Graphics 520 及以上                                    |
|   硬盘 | 500MiB 及以上空余空间                                           |
|   系统 | Windows 7 以上，或其他支持 Unity 2018.3.12f1 运行的桌面操作系统 |
| 显示器 | 换算至 96dpi 后大小在 720x720 px 以上                           |

# 目标系统功能需求

<!-- 不是我说，这玩意搞这么多花哨的图表有用么？本质上还是列表啊 -->

软件工程模拟器的功能如下所示：

- 读取配置
- 选择主菜单选项
- 存取存档
- 读写设置项
- 游戏内部运行（执行游戏逻辑）

由于游戏的使用者只有玩家一个人，且涉及到的用例事项较多，在文章内用列表方式列举用例比绘制用例图更加直观。因此以下所有用例项目中都将直接使用列表展示用例，并省去说明中使用者这一属性。

## 辅助类

### 键位分配器

要求：根据不同模块的激活状态自动分配键位触发

大致原理：

1. 任何需要键盘触发的元素需要事先注册到键位分配器上
2. 在运行时每帧判断当前激活的元素/激活的元素向分配器发送自己被激活的消息
3. 调用被激活元素的 callback function 实现键位的触发

### HOCON 配置文件读取器

要求：能够在运行时读取并实例化 Gamedata 目录内 Hocon 格式的配置文件。（Hocon -> Dictionary 的转化有现成的库可以做，现在至少要让每一个需要运行时读取的配置文件可以被从 dictionary 实例化）

### 等宽终端辅助工具

要求：可以辅助建立等宽字体的（伪）命令行终端，详细列举如下：

- [x] 终端大小判断
- [x] 进度条生成
- [ ] 判断字符宽度（CJK dual-width vs. monospace，以后界面有中文之类的情况可能要用到）
- [ ] 记录文件格式化器（最好可以像 Linux 开机的那样……嘛这算是痴人说梦了）
- [ ] 终端字符渲染（定宽行、从上向下滚动直至溢出）
- [ ] 想起来再补充

## 读取配置

用例：

- 读取配置和设置

### 读取配置和设置

输入：N/A  
系统响应：将配置文件夹中的配置文件和设置文件读取进内存，并赋值给游戏内的相应对象。  
输出：显示“正在加载”  
前置条件：游戏启动  
后置条件：进入菜单界面  

活动步骤：

1. 玩家打开游戏。
2. 游戏显示“正在加载”（同时扫描配置文件夹，并读取文件）。
3. 玩家被导航至主菜单。

异常处理：

- 配置文件格式有误或损坏，该配置文件被自动忽略，相关错误被记录并提示。
- 设置文件有误或损坏，错误的值被置为默认值，相关错误被记录并提示。

注：配置文件使用的是 HOCON 格式，因此需要编写从其句法分析后的格式转换为各配置类的转换器。

## 选择主菜单选项

用例：

- 开始新游戏
- 加载存档
- 选择设置
- 查看制作人员表
- 退出

### 开始新游戏

输入：新游戏参数  
系统响应：创建新游戏，并进入游戏界面  
输出：游戏内界面  
前置条件：加载完成并进入主菜单  
后置条件：进入游戏

活动步骤：

1. 玩家点击“新游戏”按钮。
2. 程序显示创建游戏界面。
3. 玩家输入游戏参数。
4. 玩家进入游戏。

异常处理：

- 信息不全或错误，程序给出错误信息，玩家无法创建游戏。

### 加载存档

输入：被选择的存档  
系统响应：进入所选存档的游戏  
输出：游戏内界面  
前置条件：加载完成并进入主菜单  
后置条件：进入游戏

活动步骤：

1. 玩家点击“加载存档”按钮。
2. 程序展示存档选择界面。
3. 玩家选择存档。
4. 玩家进入游戏。

异常处理：

- 存档文件错误或损坏，程序给出错误信息，玩家无法进入游戏。

### 查看设置

输入：N/A  
系统响应：显示设置菜单  
输出：设置菜单  
前置条件：加载完成并进入主菜单  
后置条件：进入设置界面

活动步骤：

4. 玩家点击“设置”按钮。
5. 程序展示设置界面。

异常处理：

N/A

### 查看制作人员表

输入：N/A  
系统响应：展示制作人员表  
输出：N/A  
前置条件：加载完成并进入主菜单  
后置条件：N/A

活动步骤：

1. 玩家点击“制作人员表”按钮。
2. 程序展示制作人员表和开源协议。
3. 玩家可以在中途或展示完毕后点击退出。

异常处理：

N/A

### 退出游戏

输入：N/A  
系统响应：退出游戏  
输出：N/A  
前置条件：N/A  
后置条件：N/A

活动步骤：

1. 玩家点击“退出”按钮或点击窗体关闭按钮。
2. 游戏退出。

异常处理：

- 如果该项功能在游戏内调用，程序会在存储完当前存档后退出。

## 读写设置项

用例：

- 显示设置
- 应用并存储设置

### 显示设置

输入：N/A  
系统响应：显示设置项列表  
输出：设置项列表  
前置条件：玩家打开设置界面  
后置条件：N/A

活动步骤：

1. 系统显示当前设置项与其值。

异常处理：

N/A

### 应用并存储设置

输入：玩家修改后的设置项  
系统响应：应用并存储设置  
输出：存储成功并返回  
前置条件：玩家在设置界面内  
后置条件：设置存储成功并应用到游戏内

活动步骤：

1. 玩家修改设置。
2. 玩家点击“确定”。
3. 系统应用设置并退出设置界面。

异常处理：

- 玩家输入的数值有误，系统拒绝存储并提示玩家修改错误。

## 游戏内部运行

用例：

- 每帧固定更新
- 玩家招聘员工
- 玩家解雇员工
- 玩家接单
- _玩家修改任务参数？_
- 玩家完成任务
- 玩家放弃任务
- _玩家与员工互动？_
- _玩家调整公司决策？_
- 玩家贷款
- _玩家还款？_
- 玩家调整时间加速倍率
- 随机事件发生

标有“？”的用例为还未确定的特性。

注：
- 本需求下的用例全部带有前置条件“游戏中”，在以下的叙述中将被省略。
- 标有 `（时间暂停）` 的活动步骤在开始执行时游戏时间将会被暂停，直至 `（时间恢复）` 标志的步骤或活动结束为止。

### 每帧固定更新

输入：N/A  
系统响应：更新游戏物体数据  
输出：显示数据更新  

活动步骤：

1. 根据当前帧对应的游戏时间、员工基础效率等信息计算员工的当前效率
2. 根据员工效率和项目信息计算员工在一帧内完成的工作量
3. 根据工作量更新项目信息
4. 更新员工的熟练度、基础效率、压力值、健康值等信息
5. 更新公司的声望、资金、员工总状态等信息
6. 更新可招聘人员、可接单列表等信息
7. 进行随机事件的条件判断和触发
8. 更新办公室环境视图中员工的位置和动作

异常处理：

- 公司没有足够资产，公司破产、游戏失败

注：每帧固定更新不需要用户触发，在更新中系统根据时间加速倍率和帧时间计算当前帧中游戏物体的各个参数值，并更新游戏界面上展示的结果。

### 玩家招聘员工

输入：员工列表中被招聘的员工  
系统响应：将员工从可招聘列表移至员工列表  
输出：员工被加入员工列表

活动步骤：

1. 玩家点击招聘（时间暂停）
2. 展示所有可以招的人的列表
3. 读取玩家选择的员工
4. （游戏时间第二天）将员工加入员工列表
5. 预付给员工 2 个月的薪水（游戏内部规则，暂定）

异常处理：

N/A（玩家只能在有限的列表中选择）

### 玩家解雇员工

输入：玩家选择解聘的员工  
系统响应：员工被员工列表中移动到可招聘列表  
输出：员工从员工列表消失

活动步骤：

1. 玩家从员工列表内选择解雇员工（时间暂停）
2. 玩家确认解雇员工
3. 将员工从员工列表移至可招聘列表
4. 付给员工薪资与离职赔偿

异常处理：

N/A（同上）

### 玩家接单

输入：被接受的任务、玩家选择分配的资源  
系统响应：将任务从可接任务列表移至当前任务列表  
输出：任务被加入当前任务列表

活动步骤：

1. 玩家点击接单（时间暂停）
2. 展示可接任务列表
3. 读取玩家选择的任务
4. 将任务加入当前任务列表
5. 公司增加与任务相符的资金、声望等
6. 玩家为任务分配人员、资金等资源，并安排时间、计划

异常处理：

N/A（同上）

### 玩家修改任务参数

输入：要修改的任务、被修改的参数  
系统响应：任务相关参数被修改  
输出：修改后的任务参数

活动步骤：

1. 玩家选择要修改的任务（时间暂停）
2. 玩家修改任务参数（如人员、计划等）
3. 玩家确认修改
4. 任务相关资源被修改，按照规则设置即时或第二天生效

异常处理：

- 修改计划不合法，在不合法的输入处出现提示，并阻止玩家提交

### 玩家放弃任务

输入：玩家选择放弃的任务  
系统响应：任务被从列表中删除  
输出：任务从列表中消失

活动步骤：

1. 玩家从任务列表内选择放弃任务（时间暂停）
2. 将任务从当前任务列表里删除
3. 公司被扣除与任务相符的违约金、声望等
4. 任务相关人员和资源被释放

异常处理：

N/A（同上上）

### 玩家完成任务

输入：N/A（任务自动完成）  
系统响应：任务被从列表中消失  
输出：任务从列表中消失

活动步骤：

1. 任务从当前任务列表里被删除
2. 公司获得与任务相符的资金、声望等
3. 任务相关人员和资源被释放
4. 玩家收到任务完成的提示（可以有时间暂停或时间加速取消）

异常处理：

N/A（同上）

### 玩家调整公司策略

输入：新的公司策略  
系统响应：公司策略被更改  
输出：公司策略被更改

活动步骤：

1. 玩家选择调整公司策略（时间暂停）
2. 玩家输入新的策略
3. 玩家确定更改
4. 公司策略更改，按设定即时或第二天生效

异常处理：

- 玩家输入不合法，出现错误提示，并阻止玩家提交

### 玩家贷款

输入：玩家选择贷款来源  
系统响应：公司从选择的来源贷到款  
输出：资金增加，定期还款

活动步骤：

1. 玩家选择贷款（时间暂停）
2. 玩家选择贷款来源
3. 玩家确定贷款
4. 公司资金增加，同时定期（每月）向贷款公司支出一定资产还款

异常处理：

- 公司没有足够资金还款，公司破产、游戏失败

### 玩家调整时间加速倍率

输入：新的时间加速倍率  
系统响应：时间流逝速度加快  
输出：新的时间流速

活动步骤：

1. 玩家通过鼠标选择或快捷键调整时间流速
2. 时间流速改变

异常处理：

N/A

注：

- 目前设定时间流速有以下选择：
  - 1x（正常流速，暂定一分钟一天）
  - 2x
  - 4x
  - 8x
  - 16x
  - 32x（待定）

### 随机事件发生

输入：随机事件处置方式  
系统响应：随机事件发生  
输出：随机事件提示、影响

活动步骤：

1. 计算随机事件的触发器，如果发生执行下面步骤
2. 调整时间流速为 1x
3. 按照随机事件触发器定义修改资源情况
4. 向玩家发送随机事件发生的提示，指示发生事件和影响
5. 玩家选择处置事件的方式（如果有）

异常处理：

N/A

如果游戏需要更多的运行时操作或计算，在此下补充

# 目标系统非功能需求

## 性能需求

以上所有每帧更新的操作需要在最多 1/30 s 内计算完成。

期望：在装备 Intel i5-6300U 和 Intel HD Graphics 520、屏幕分辨率 2736 x 1824 的低性能测试机上平均帧率要能达到 30fps。

## 可扩展性

游戏内的配置和参数在开发后期需要可以通过修改外部配置文件更改。如果可能的话还可以添加插件系统支持玩家自定义插件（mod）。

## 可升级性

游戏升级时，玩家的存档不应当损坏。

## 玩家教程

在开发完成之后，游戏内或游戏外应有给玩家看的教程手册或帮助文档。

<!-- 你不能指望所有玩家都来翻游戏源代码来了解游戏如何操作对不对 -->

# 目标系统其他需求

N/A

# 目标系统假设与约束条件

N/A
